*mado-scratch.nvim*    The fastest way to open scratch buffers for Neovim

Author: aiya000
License: MIT license

==============================================================================
CONTENTS                *mado-scratch-contents*

INTRODUCTION            |mado-scratch-introduction|
SETUP                   |mado-scratch-setup|
USAGE                   |mado-scratch-usage|
INTERFACE               |mado-scratch-interface|
  AUTOCMDS              |mado-scratch-autocmds|
  CONFIGURATION         |mado-scratch-configuration|
  COMMANDS              |mado-scratch-commands|
  FUNCTIONS             |mado-scratch-functions|
CHANGELOG               |mado-scratch-changelog|


==============================================================================
INTRODUCTION            *mado-scratch-introduction*

** No more hassle with file paths! **
The fastest way to open an instant scratch buffer for Neovim.

This is a modern Lua-based implementation for Neovim, rewritten from the
original Vim script version.

Supercharge with vim-quickrun!
Combine it with vim-quickrun (https://github.com/thinca/vim-quickrun) to
execute code instantly!
>
  " Open a TypeScript buffer
  :MadoScratchOpen ts

  " Write TypeScript code
  " ...

  " ...and run it immediately!
  :QuickRun
<
Please see the |mado-scratch-usage| section for usage details.

Repository:
https://github.com/aiya000/nvim-mado-scratch


==============================================================================
SETUP                   *mado-scratch-setup*

Install the plugin using your favorite plugin manager:

Using lazy.nvim: >lua
  {
    'aiya000/nvim-mado-scratch',
    config = function()
      require('mado-scratch').setup({
        -- your configuration here
      })
    end
  }
<

Using packer.nvim: >lua
  use {
    'aiya000/nvim-mado-scratch',
    config = function()
      require('mado-scratch').setup({
        -- your configuration here
      })
    end
  }
<

This plugin will work with default settings without any configuration.

Meaning:
  - The config (opts) property is optional
  - You can skip it if you want to use default settings
  - Or you want to configure your configuration,
    - See |mado-scratch-configuration|


==============================================================================
USAGE                   *mado-scratch-usage*

Open a scratch buffer with or without a file extension:
>
  " Open a new scratch buffer without file extension and filetype
  :MadoScratchOpen

  " Open a new scratch buffer with markdown filetype
  :MadoScratchOpen md

  " Open a new scratch buffer with TypeScript filetype
  :MadoScratchOpen ts

  " Open a persistent file buffer (auto-saved)
  :MadoScratchOpenFile js

  " Open next scratch buffer (force new buffer creation)
  :MadoScratchOpenNext py

  " Open with custom split method and size
  :MadoScratchOpen md sp 10
  :MadoScratchOpen ts vsp 80
  :MadoScratchOpen hs float-fixed 80x40

  " Clean up all scratch buffers and files
  :MadoScratchClean
<

You can specify:
1. File extension (optional): md, ts, js, py, etc. or `--no-file-ext`
2. Open method (optional):
   - sp (horizontal split)
   - vsp (vertical split)
   - tabnew (new tab)
   - float-fixed (floating window with fixed size)
   - float-aspect (floating window with aspect ratio)
3. Buffer size (optional):
   - For sp: number for height
   - For vsp: number for width
   - For float-fixed: (width)x(height) (e.g., 80x40)
   - For float-aspect: (width)x(height) (e.g., 0.9x0.8)
   - For tabnew: not applicable


==============================================================================
INTERFACE               *mado-scratch-interface*

------------------------------------------------------------------------------
AUTOCMDS                *mado-scratch-autocmds*

                        *User-MadoScratchBufferOpened*
User MadoScratchBufferOpened
  Triggered after a scratch buffer is opened by this plugin.
  This event is triggered for all buffer types (temporary or persistent)
  and all open methods (split, vsplit, tab, floating).

  You can use this autocmd to perform custom actions when a scratch buffer
  is opened, such as setting buffer-local options, mappings, or running
  specific commands.

  Example: >
    " Set buffer-local option when scratch buffer is opened
    autocmd User MadoScratchBufferOpened setlocal wrap

    " Or using Lua:
    vim.api.nvim_create_autocmd('User', {
      pattern = 'MadoScratchBufferOpened',
      callback = function()
        vim.opt_local.wrap = true
        print('Scratch buffer opened!')
      end,
    })
<

------------------------------------------------------------------------------
CONFIGURATION           *mado-scratch-configuration*

Configure the plugin by calling the setup function:
>lua
  require('mado-scratch').setup({
    -- File patterns for temporary and persistent buffers
    file_pattern = {
      when_tmp_buffer = '/tmp/mado-scratch-tmp-%d',
      when_file_buffer = '/tmp/mado-scratch-file-%d',
    },

    -- Options when you didn't specify to the commands
    default_file_ext = 'md',                                -- Default file extension
    default_open_method = { method = 'sp', height = 15 },   -- Default open method and size

    -- Behavior options
    auto_save_file_buffer = true,      -- Auto-save file buffers on InsertLeave and before buffer destruction
    use_default_keymappings = false,   -- Enable default keymaps

    -- Auto-hide settings (like scratch.vim)
    auto_hide_buffer = {
      when_tmp_buffer = false,         -- Auto-hide temporary buffers
      when_file_buffer = false,        -- Auto-hide persistent buffers
    },
  })
<

The above setup properties are the default value of each configuration option.

NOTE:
See below file to see what types the each options have :
  - `../lua/mado-scratch/init.lua`
    - and `mado_scratch.Options` type


                        *option.mado_scratch_file_pattern*
file_pattern ~
  Default: >lua
  {
    when_tmp_buffer = '/tmp/mado-scratch-tmp-%d',
    when_file_buffer = '/tmp/mado-scratch-file-%d',
  }
<
  File path patterns for temporary and persistent buffers. The `%d` will be
  replaced with an incremental number.

                        *option.mado_scratch_default_file_ext*
default_file_ext ~
  Default: `'md'`
  Default file extension when no extension is specified.

                        *option.mado_scratch_default_open_method*
default_open_method ~
  Default: `{ method = 'sp', height = 15 }`
  Default method to open buffers with size configuration.

  Examples:
  - `{ method = 'sp', height = 15 }` - horizontal split with height
  - `{ method = 'vsp', width = 30 }` - vertical split with width
  - `{ method = 'float-aspect', scale = { width = 0.8, height = 0.8 } }` - floating window with aspect ratio (requires plenary.nvim)
  - `{ method = 'float-fixed', size = { width = 80, height = 24 } }` - floating window with fixed size (requires plenary.nvim)
  - `{ method = 'tabnew' }` - new tab (no size needed)

  `height/width/scale/size` is optional field.
  When you omit it:
  - For `sp` and `vsp`: The created window is not resized
  - For `float-aspect` and `float-fixed`: Default scale/size is used

                        *option.mado_scratch_auto_save_file_buffer*
auto_save_file_buffer ~
  Default: `true`
  Automatically save file buffers when leaving insert mode (InsertLeave event)
  or before buffer destruction (BufDelete, BufWipeout, BufUnload events).

  WARNING: If set to `false` and using floating windows, unsaved content may be
  lost when closing the window without explicitly saving (`:w`). This is because
  floating windows may close without triggering the buffer destruction events.
  It's recommended to keep this option `true` if you use floating windows.
  (Fix in progress: https://github.com/aiya000/nvim-mado-scratch/issues/19)

                        *option.mado_scratch_use_default_keymappings*
use_default_keymappings ~
  Default: `false`
  Enable default keymappings. When enabled:
  - `<leader>b` → `:MadoScratchOpen`
  - `<leader>B` → `:MadoScratchOpenFile`
  - `<leader><leader>b` → `:MadoScratchOpen ` (interactive)
  - `<leader><leader>B` → `:MadoScratchOpenFile ` (interactive)

                        *option.mado_scratch_auto_hide_buffer*
auto_hide_buffer ~
  Default: >lua
    {
      when_tmp_buffer = false,
      when_file_buffer = false,
    }
  <
  If true, auto-hide buffers when leaving the window, like scratch.vim.

------------------------------------------------------------------------------
COMMANDS                *mado-scratch-commands*

                        *:MadoScratchOpen*
:MadoScratchOpen [file_ext] [open_method] [buffer_size]
  Open a temporary scratch buffer.

  Parameters:
  - file_ext: File extension (e.g., 'md', 'ts') or '--no-file-ext'
  - open_method: 'sp', 'vsp', 'tabnew', 'float-fixed', or 'float-aspect'
  - buffer_size: Number for height/width, or WIDTHxHEIGHT for float-fixed

  Examples: >
    :MadoScratchOpen
    :MadoScratchOpen md
    :MadoScratchOpen ts sp 10
    :MadoScratchOpen hs vsp 80
    :MadoScratchOpen py float-fixed 80x40
    :MadoScratchOpen lua float-aspect 0.9x0.8
<
                        *:MadoScratchOpenFile*
:MadoScratchOpenFile [file_ext] [open_method] [buffer_size]
  Open a persistent file buffer (auto-saved).
  Same parameters as |:MadoScratchOpen|.

                        *:MadoScratchOpenNext*
:MadoScratchOpenNext [file_ext] [open_method] [buffer_size]
  Force open a new temporary scratch buffer.
  Same parameters as |:MadoScratchOpen|.

                        *:MadoScratchOpenFileNext*
:MadoScratchOpenFileNext [file_ext] [open_method] [buffer_size]
  Force open a new persistent file buffer.
  Same parameters as |:MadoScratchOpen|.

                        *:MadoScratchClean*
:MadoScratchClean
  Clean up all scratch buffers and files.


------------------------------------------------------------------------------
FUNCTIONS               *mado-scratch-functions*

These functions are available through the Lua API:

                        *mado-scratch.setup()*
require('mado-scratch').setup({config})
  Setup the plugin with the given configuration.

                        *mado-scratch.get_config()*
require('mado-scratch').get_config()
  Get the current configuration.

require('mado-scratch.buffer').open(opening_next, ...)
  Open a temporary scratch buffer.

require('mado-scratch.buffer').open_file(opening_next, ...)
  Open a persistent file buffer.

require('mado-scratch.buffer').clean()
  Clean up all scratch buffers and files.


==============================================================================
CHANGELOG                    *mado-scratch-changelog*

- 2025-12-24
  - `{ method = 'float', ... }` is renamed to `{ method = 'float-fixed', ... }`
    - For backward compatibility, `float` is still supported as alias of `float-fixed`

- Also see https://github.com/aiya000/nvim-mado-scratch/commits/main
  - We use Conventional Commits for the changelog
  - In Conventional Commits, a bang (!) indicates breaking changes
    - Please update your config if you encounter these commits
    - Example: `change!: Change argument types of 'create_foo()' in 'mado-scratch.foo' module`

- - -

2025~
- Create the new repository: https://github.com/aiya000/nvim-mado-scratch

2024
- Create original repository: https://github.com/aiya000/nvim-mado-scratch

vim:tw=78:ts=2:ft=help:norl:expandtab:
